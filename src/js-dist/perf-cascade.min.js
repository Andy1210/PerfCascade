/*PerfCascade build:21/12/2015 */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d={newTextNode:function(a){return document.createTextNode(a)},newTag:function(a,b,c){b=b||{};var e=document.createElement(a);for(var f in b)"text"!=f&&(e[f]=b[f]);return b.text?e.textContent=b.text:b.childElement&&("object"==typeof b.childElement?b.childElement instanceof NodeList?Array.prototype.slice.call(b.childElement,0).forEach(function(a){e.appendChild(a)}):e.appendChild(b.childElement):e.appendChild(d.newTextNode(b.childElement))),b["class"]&&(e.className=b["class"]),e.style.cssText=c||"",e},tableFactory:function(a,b,c){void 0===a&&(a="");var e=d.newTag("div",{id:a,"class":"table-holder"}),f=d.newTag("table"),g=d.newTag("thead");return g.appendChild(b(d.newTag("tr"))),f.appendChild(g),f.appendChild(c(d.newTag("tbody"))),e.appendChild(f),e},combineNodes:function(a,b){var c=document.createElement("div");return"object"==typeof a?c.appendChild(a):"string"==typeof a&&c.appendChild(d.newTextNode(a)),"object"==typeof b?c.appendChild(b):"string"==typeof b&&c.appendChild(d.newTextNode(b)),c.childNodes},addClass:function(a,b){return a.classList?a.classList.add(b):a.setAttribute("class",a.getAttribute("class")+" "+b),a},removeClass:function(a,b){return a.classList?a.classList.remove(b):a.setAttribute("class",a.getAttribute("class").replace(new RegExp("(\\s|^)"+b+"(\\s|$)","g"),"$2")),a},removeAllChildren:function(a){for(;a.childNodes.length>0;)a.removeChild(a.childNodes[0])}};Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=d},{}],2:[function(a,b,c){var d={newEl:function(a,b,c){var d=document.createElementNS("http://www.w3.org/2000/svg",a);b=b||{};for(var e in b)"text"!=e&&d.setAttributeNS(null,e,b[e]);return d.textContent=b.text||"",d.style.cssText=c||"",d},newTextEl:function(a,b,c){return void 0===c&&(c=""),d.newEl("text",{fill:"#111",y:b.toString(),text:a},c+" text-shadow:0 0 4px #fff;")},getNodeTextWidth:function(a){var b=d.newEl("svg:svg",{},"visibility:hidden;");b.appendChild(a),window.document.body.appendChild(b);var c=a.getBBox().width;return b.parentNode.removeChild(b),c}};Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=d},{}],3:[function(a,b,c){var d=a("../helpers/svg"),e=a("../helpers/dom"),f={setupTimeLine:function(a){var b=a.durationMs/100,c=a.blocks.filter(function(a){return"number"==typeof a.start&&"number"==typeof a.total}).sort(function(a,b){return(a.start||0)-(b.start||0)}),f=a.marks.length>0?a.marks.reduce(function(a,b){return Math.max("number"==typeof a?a:0,d["default"].getNodeTextWidth(d["default"].newTextEl(b.name,0)))}):0,g=25*(c.length+1),h=g+f+35,i=d["default"].newEl("svg:svg",{height:Math.floor(h),"class":"water-fall-chart"}),j=d["default"].newEl("g",{"class":"labels"}),k=d["default"].newEl("line",{x1:"0",y1:"0",x2:"0",y2:g,"class":"line-end"}),l=d["default"].newEl("line",{x1:"0",y1:"0",x2:"0",y2:g,"class":"line-start"}),m=function(a){var b=a.target;e["default"].addClass(b,"active");var c=b.x.baseVal.valueInSpecifiedUnits+b.width.baseVal.valueInSpecifiedUnits+"%",d=b.x.baseVal.valueInSpecifiedUnits+"%";k.x1.baseVal.valueAsString=c,k.x2.baseVal.valueAsString=c,l.x1.baseVal.valueAsString=d,l.x2.baseVal.valueAsString=d,e["default"].addClass(k,"active"),e["default"].addClass(l,"active"),b.parentNode.appendChild(k),b.parentNode.appendChild(l)},n=function(a){e["default"].removeClass(a.target,"active"),e["default"].removeClass(k,"active"),e["default"].removeClass(l,"active")},o=function(a,c,e,f,g,h,i){var j,k=d["default"].newEl("rect",{width:a/b+"%",height:c-1,x:Math.round(e/b*100)/100+"%",y:f,"class":(i&&i.length>0?"time-block":"segment")+" "+(g||"block-other")});return h&&k.appendChild(d["default"].newEl("title",{text:h})),k.addEventListener("mouseenter",m),k.addEventListener("mouseleave",n),i&&i.length>0?(j=d["default"].newEl("g"),j.appendChild(k),i.forEach(function(a){a.total>0&&"number"==typeof a.start&&j.appendChild(o(a.total,8,a.start||.001,f,a.cssClass,a.name+" ("+Math.round(a.start)+"ms - "+Math.round(a.end)+"ms | total: "+Math.round(a.total)+"ms)"))}),j):k},p=function(a){var c=d["default"].newEl("rect",{width:(a.total||1)/b+"%",height:g,x:(a.start||.001)/b+"%",y:0,"class":a.cssClass||"block-other"});return c.appendChild(d["default"].newEl("title",{text:a.name})),c},q=function(){for(var b=d["default"].newEl("g",{"class":"time-scale full-width"}),c=0,e=a.durationMs/1e3,f=100/e;e>=c;c++){var h=d["default"].newTextEl(c+"sec",g);c>e-.2?(h.setAttribute("x",f*c-.5+"%"),h.setAttribute("text-anchor","end")):h.setAttribute("x",f*c+.5+"%");var i=d["default"].newEl("line",{x1:f*c+"%",y1:"0",x2:f*c+"%",y2:g});b.appendChild(i),b.appendChild(h)}return b},r=function(){var c=d["default"].newEl("g",{transform:"scale(1, 1)","class":"marker-holder"});return a.marks.forEach(function(f,h){var i=f.startTime/b,j=d["default"].newEl("g",{"class":"mark-holder"}),k=d["default"].newEl("g",{"class":"line-holder"}),l=d["default"].newEl("g",{"class":"line-lable-holder",x:i+"%"});f.x=i;var m=d["default"].newTextEl(f.name,g+25);m.setAttribute("x",i+"%"),m.setAttribute("stroke",""),k.appendChild(d["default"].newEl("line",{x1:i+"%",y1:0,x2:i+"%",y2:g})),a.marks[h-1]&&f.x-a.marks[h-1].x<1&&(m.setAttribute("x",a.marks[h-1].x+1+"%"),f.x=a.marks[h-1].x+1),k.appendChild(d["default"].newEl("line",{x1:i+"%",y1:g,x2:f.x+"%",y2:g+23}));var n=!1,o=function(a){n||(n=!0,e["default"].addClass(k,"active"),j.parentNode.appendChild(j))},p=function(a){n=!1,e["default"].removeClass(k,"active")};m.addEventListener("mouseenter",o),m.addEventListener("mouseleave",p),l.appendChild(m),j.appendChild(d["default"].newEl("title",{text:f.name+" ("+Math.round(f.startTime)+"ms)"})),j.appendChild(k),c.appendChild(j),j.appendChild(l)}),c};return i.appendChild(q()),i.appendChild(r()),a.lines.forEach(function(a,b){i.appendChild(p(a))}),c.forEach(function(a,c){var e=a.total||1,f=25*c;i.appendChild(o(e,25,a.start||.001,f,a.cssClass,a.name+" ("+a.start+"ms - "+a.end+"ms | total: "+a.total+"ms)",a.segments));var g=a.name.length>30&&a.name.indexOf("?")>0,h=g?a.name.split("?")[0]+"?....":a.name,k=d["default"].newTextEl(h+" ("+Math.round(a.total)+"ms)",f+(a.segments?20:17));k.appendChild(d["default"].newEl("title",{text:a.name})),(a.total||1)/b>10&&d["default"].getNodeTextWidth(k)<200?(k.setAttribute("class","inner-label"),k.setAttribute("x",(a.start||.001)/b+.5+"%"),k.setAttribute("width",e/b+"%")):(a.start||.001)/b+e/b<80?k.setAttribute("x",(a.start||.001)/b+e/b+.5+"%"):(k.setAttribute("x",(a.start||.001)/b-.5+"%"),k.setAttribute("text-anchor","end")),k.style.opacity=a.name.match(/js.map$/)?"0.5":"1",j.appendChild(k)}),i.appendChild(j),i}};Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=f},{"../helpers/dom":1,"../helpers/svg":2}],4:[function(a,b,c){function d(a){alert(a)}function e(a){var b=a.target.files;if(!b)return void d("Failed to load HAR file");var c=new FileReader;c.onload=function(a){var b;try{b=JSON.parse(a.target.result)}catch(a){return void d("File does not seem to be a valid HAR file")}f(b.log)},c.readAsText(b[0])}function f(a){var b=i["default"].transfrom(a);h["default"].removeAllChildren(j),j.appendChild(g["default"].setupTimeLine(b))}var g=a("./helpers/waterfall"),h=a("./helpers/dom"),i=a("./transformers/har"),j=document.getElementById("output");document.getElementById("fileinput").addEventListener("change",e,!1),window.fetch("test-data/www.bbc.com.har").then(function(a){return a.json().then(function(a){return f(a.log)})})},{"./helpers/dom":1,"./helpers/waterfall":3,"./transformers/har":5}],5:[function(a,b,c){var d=a("../typing/time-block"),e=function(){function a(){}return a.makeBlockCssClass=function(a){var b=function(a){var b=a.split("/");switch(b[0]){case"image":return"image";case"font":return"font"}switch(b[1]){case"svg+xml":case"html":return"html";case"css":return"css";case"vnd.ms-fontobject":case"font-woff":case"font-woff2":case"x-font-truetype":case"x-font-opentype":case"x-font-woff":return"font";case"javascript":case"x-javascript":case"script":case"json":return"javascript";case"x-shockwave-flash":return"flash"}return"other"};return"block-"+b(a)},a.transfrom=function(a){var b=this;console.log("HAR created by %s(%s) of %s page(s)",a.creator.name,a.creator.version,a.pages.length),window.data=a;var c=0,e=a.entries.filter(function(b){return b.pageref===a.pages[0].id}).map(function(e){var f=a.pages.filter(function(a){return a.id===e.pageref})[0],g=new Date(f.startedDateTime),h=new Date(e.startedDateTime),i=h.getTime()-g.getTime();c<i+e.time&&(c=i+e.time);e.timings;return new d["default"](e.request.url,i,i+e.time,b.makeBlockCssClass(e.response.content.mimeType),b.buildSectionBlocks(i,e.timings),e)});return console.table(e.map(function(a){return{name:a.name,start:a.start,end:a.end,TEMP:a.cssClass,total:a.total}})),console.log(e),{durationMs:c,blocks:e,marks:[],lines:[]}},a.buildSectionBlocks=function(a,b){return["blocked","dns","connect","send","wait","receive","ssl"].reduce(function(c,e){if(b[e]&&-1!==b[e]){var f=c.length>0?c[c.length-1].end:a;return c.concat([new d["default"](e,f,f+b[e],"block-"+e)])}return c},[])},a}();Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=e},{"../typing/time-block":6}],6:[function(a,b,c){var d=function(){function a(a,b,c,d,e,f){void 0===d&&(d=""),void 0===e&&(e=[]),this.name=a,this.start=b,this.end=c,this.cssClass=d,this.segments=e,this.rawResource=f,this.total="number"!=typeof b||"number"!=typeof c?void 0:c-b}return a}();Object.defineProperty(c,"__esModule",{value:!0}),c["default"]=d},{}]},{},[4]);